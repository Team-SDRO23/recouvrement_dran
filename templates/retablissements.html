{% extends 'base.html' %}
{% block title %}Clients Ã  rÃ©tablir{% endblock %}

{% block content %}
</br></br>
<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h5 mb-0">Clients Ã©ligibles</h1>
    <div class="d-flex gap-2">
      <a href="{{ url_for('download_retab_excel') }}" class="btn btn-sm btn-success">ðŸ“¥ Excel</a>
      <a href="{{ url_for('download_retab_pdf') }}" class="btn btn-sm btn-danger">ðŸ“¥ PDF</a>
    </div>
  </div>

  {% if stats %}
  <div class="row g-3 mb-3">
    <div class="col-6 col-md-3">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <div class="text-muted small">Clients total</div>
          <div class="fs-5 fw-semibold"> {{ "{:,}".format(stats.nb_clients_total) }}  </div>
        </div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <div class="text-muted small">Ã‰ligibles</div>
          <div class="fs-5 fw-semibold">{{ stats.nb_eligibles_total }}</div>
        </div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <div class="text-muted small">Total payÃ©s</div>
          <div class="fs-5 fw-semibold">{{ "{:,}".format(stats.total_payes_total) }}</div>
        </div>
      </div>
    </div>
    <div class="col-6 col-md-3">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <div class="text-muted small">Reste Ã  payer</div>
          <div class="fs-5 fw-semibold">{{ "{:,}".format(stats.reste_total) }}</div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {% if table_html %}
    <div class="table-responsive">
      {{ table_html | safe }}
    </div>
  {% else %}
    <div class="alert alert-info">Aucune donnÃ©e Ã  afficher.</div>
  {% endif %}
</div>

<!-- Alignement Ã  gauche -->
<style>
  #table-retab th, #table-retab td { text-align: left !important; vertical-align: middle; }
  .dataTables_wrapper .dataTables_paginate .paginate_button { padding: .25rem .5rem; }
</style>

<!-- DataTables (Bootstrap 5) -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<script>
  $(function () {
    $('#table-retab').DataTable({
      pageLength: 10,
      lengthChange: false,
      ordering: true,
      searching: true,
      language: { url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/fr-FR.json" }
    });
  });
</script>
{% endblock %}
